<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Pencarian Aset</title><style>body{font-family:Arial,sans-serif;margin:0;padding:0;width:100%;height:100vh;display:flex;flex-direction:column;justify-content:space-between;background-color:#f0f0f0}header{max-width:90%;width:100%;margin:auto;background-color:#B2EBF2;color:#333;text-align:center;padding:10px 0;border-radius:8px 8px 0 0;box-shadow:0 4px 8px rgba(0,0,0,0.1);height:20px;display:flex;align-items:center;justify-content:center}.container{max-width:90%;width:100%;margin:auto;padding:20px;box-sizing:border-box;background-color:#fff;border-radius:8px;box-shadow:0 4px 8px rgba(0,0,0,0.1);flex-grow:1;overflow-y:auto;margin-top:20px;margin-bottom:20px;position:relative}input,button{padding:10px;margin:10px 0;width:100%;box-sizing:border-box;border:none;border-radius:4px;cursor:pointer}input{background-color:#f9f9f9;border:1px solid #ccc}button{background-color:#42f5ad;color:#000;transition:background-color 0.3s ease}button:hover{background-color:#2ecc71}#stop-scan-button{display:none;background-color:#ff4d4d;color:#000}#stop-scan-button:hover{background-color:#ff1a1a}img{max-width:100%;height:auto;margin-top:20px;border:5px solid #B2EBF2;border-radius:10px;box-shadow:0 4px 8px rgba(0,0,0,0.1)}footer{max-width:90%;width:100%;margin:auto;text-align:center;padding:10px 0;background-color:#333;color:#fff;font-size:14px;border-radius:0 0 8px 8px;box-shadow:0 4px 8px rgba(0,0,0,0.1);height:10px;display:flex;align-items:center;justify-content:center}table{width:100%;border-collapse:collapse;margin-top:20px;border-radius:8px;overflow:hidden;box-shadow:0 4px 8px rgba(0,0,0,0.1);table-layout:fixed}table tr:nth-child(even){background-color:#f9f9f9}table tr:nth-child(odd){background-color:#fff}table tr:hover{background-color:#e0f7fa;transition:background-color 0.3s ease}table th,table td{padding:12px;text-align:left;border-bottom:1px solid #ddd;word-wrap:break-word;white-space:normal}table th{background:linear-gradient(to right,#0074D9,#00BFFF);color:#fff;font-weight:bold;text-transform:uppercase}table td:first-child{font-weight:bold}.loading{text-align:center;font-size:16px;color:#555;animation:blink 1s infinite}@keyframes blink{0%,100%{opacity:1}50%{opacity:.5}}#qr-reader{width:100%;height:300px;margin-top:20px;border:2px solid #B2EBF2;border-radius:8px;box-shadow:0 4px 8px rgba(0,0,0,0.1)}.modal-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.5);display:flex;justify-content:center;align-items:center;z-index:1000}.modal{background-color:#fff;padding:20px;border-radius:8px;box-shadow:0 4px 8px rgba(0,0,0,0.2);text-align:center}.modal-header{font-size:18px;font-weight:bold;margin-bottom:10px}.modal button{margin-top:10px;padding:10px 20px;background-color:#42f5ad;border:none;border-radius:4px;cursor:pointer}.modal button:hover{background-color:#2ecc71}</style><script src="https://unpkg.com/html5-qrcode"></script></head><body><header><h4>CARI PROFIL ASET SARANA</h4></header><div class="container"><center>Versi Uji Coba</center><input type="text" id="nomor_aset" placeholder="Masukkan Nomor Aset"><button id="cari-aset-button" onclick="c()">Cari Aset</button><button id="scan-qr-button" onclick="s()">Scan QR Code</button><button id="stop-scan-button" onclick="t()">Tutup Pemindaian</button><div id="hasil"></div><div id="qr-reader" style="display:none"></div></div><footer id="footer">&copy; <span id="current-year"></span> mrclimis <a href="https://www.nirayu.id/" target="_blank">nirayu.id</a>. All Rights Reserved.</footer><script>function u(){const e=new Date().getFullYear();document.getElementById("current-year").textContent=e}u();async function c(){const e=document.getElementById("nomor_aset").value;if(!e){v("Peringatan","Masukkan nomor aset!");return}const t=document.getElementById("hasil");t.innerHTML='<p class="loading">Memuat data...</p>';try{const n=await fetch(`https://script.google.com/macros/s/AKfycbw6umXE8H4O_hOVAhyV9422d1taUF5mHyHlFlgGsX3-RNFvQhfAEFmGnfauVpgeshnD/exec?nomor_aset=${e}`),a=await n.json();t.innerHTML="";if(a.status==="found"){const o=a.url_foto?`https://drive.google.com/thumbnail?id=${a.url_foto}`:"https://drive.google.com/thumbnail?id=1sMu1l3EYCxC15eus0y6o0ykN8BHcDkTz";t.innerHTML=`<table><tr><th colspan="2" style="background:linear-gradient(to right,#0074D9,#00BFFF);color:#fff">PROFIL SARANA</th></tr><tr><td style="color:#f55b02">Nomor Aset</td><td>${a.nomor_aset}</td></tr><tr><td style="color:#f55b02">Nomor SIMAS</td><td>${a.nomor_simas}</td></tr><tr><td style="color:#f55b02">Jenis Sarana</td><td>${a.jenis_aset}</td></tr><tr><td style="color:#f55b02">Nama Sarana</td><td>${a.nama_aset}</td></tr><tr><td style="color:#f55b02">Sumber Anggaran</td><td>${a.sumber_anggaran}</td></tr><tr><td style="color:#f55b02">Bulan Pengadaan</td><td>${a.bulan_aset}</td></tr><tr><td style="color:#f55b02">Tahun Pengadaan</td><td>${a.tahun_aset}</td></tr><tr><td style="color:#f55b02">Lokasi</td><td>${a.lokasi_aset}</td></tr><tr><td style="color:#f55b02">Pengguna</td><td>${a.pengguna_aset}</td></tr><tr><td style="color:#f55b02">Penanggung Jawab</td><td>${a.penanggung_jawab}</td></tr><tr><td style="color:#f55b02">Jabatan</td><td>${a.jabatan}</td></tr><tr><td style="color:#f55b02">Keterangan</td><td>${a.keterangan}</td></tr><tr><td style="color:#f55b02">Jumlah</td><td>${a.jumlah_aset}</td></tr><tr><td style="color:#f55b02">Kondisi Aset</td><td>${a.kondisi_aset}</td></tr><tr><td style="color:#f55b02">Status Aset</td><td>${a.status_aset}</td></tr><tr><td style="color:#f55b02">Spesifikasi</td><td>${a.spesifikasi}</td></tr></table><p style="text-align:center">Foto:<br><img src="${o}" alt="Foto Aset" style="max-width:100%"><br></p>`}else{v("Peringatan","Data tidak ditemukan!")}}catch(r){v("Peringatan","Gagal memuat data. Silakan coba lagi.")}}let d;function s(){const e=document.getElementById("nomor_aset");e.style.display="none";const t=document.getElementById("hasil");t.innerHTML="";e.value="";const n=document.getElementById("cari-aset-button"),a=document.getElementById("scan-qr-button");n.style.display="none";a.style.display="none";const o=document.getElementById("stop-scan-button");o.style.display="block";const r=document.getElementById("qr-reader");r.style.display="block";d=new Html5QrcodeScanner("qr-reader",{fps:10,qrbox:250});d.render(c=>{d.clear();o.style.display="none";r.style.display="none";n.style.display="block";a.style.display="block";e.style.display="block";e.value=c;c()})}function t(){if(d){d.clear()}const e=document.getElementById("stop-scan-button");e.style.display="none";const n=document.getElementById("qr-reader");n.style.display="none";const a=document.getElementById("cari-aset-button"),o=document.getElementById("scan-qr-button");a.style.display="block";o.style.display="block";const r=document.getElementById("nomor_aset");r.style.display="block"}function v(e,t){const n=document.createElement("div");n.className="modal-overlay";const a=document.createElement("div");a.className="modal";a.innerHTML=`<div class="modal-header">${e}</div><p>${t}</p><button onclick="document.body.removeChild(this.parentElement.parentElement)">OK</button>`;n.appendChild(a);document.body.appendChild(n)}</script></body></html>